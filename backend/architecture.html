<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Architecture and scaffolding | A full stack approach to integrated web and native app development</title>
    <meta name="generator" content="VuePress 1.5.1">
    
    <meta name="description" content="Creating native and web apps using Vue, NativeScript and Laravel">
    <link rel="preload" href="/webdevbook/assets/css/0.styles.ff1b3640.css" as="style"><link rel="preload" href="/webdevbook/assets/js/app.add8df03.js" as="script"><link rel="preload" href="/webdevbook/assets/js/2.7bd00ffb.js" as="script"><link rel="preload" href="/webdevbook/assets/js/8.5fbba1e4.js" as="script"><link rel="prefetch" href="/webdevbook/assets/js/10.e4b20976.js"><link rel="prefetch" href="/webdevbook/assets/js/11.904536a7.js"><link rel="prefetch" href="/webdevbook/assets/js/12.b7a199c6.js"><link rel="prefetch" href="/webdevbook/assets/js/13.91b6d744.js"><link rel="prefetch" href="/webdevbook/assets/js/14.77f13f39.js"><link rel="prefetch" href="/webdevbook/assets/js/15.6028fea7.js"><link rel="prefetch" href="/webdevbook/assets/js/16.5e9aa680.js"><link rel="prefetch" href="/webdevbook/assets/js/17.9b2897ed.js"><link rel="prefetch" href="/webdevbook/assets/js/18.9529298c.js"><link rel="prefetch" href="/webdevbook/assets/js/19.f15a1650.js"><link rel="prefetch" href="/webdevbook/assets/js/20.fcf3d7bc.js"><link rel="prefetch" href="/webdevbook/assets/js/21.24b1c78f.js"><link rel="prefetch" href="/webdevbook/assets/js/22.c12deafb.js"><link rel="prefetch" href="/webdevbook/assets/js/23.786840a6.js"><link rel="prefetch" href="/webdevbook/assets/js/24.b293d63a.js"><link rel="prefetch" href="/webdevbook/assets/js/25.268e61d3.js"><link rel="prefetch" href="/webdevbook/assets/js/26.e9510459.js"><link rel="prefetch" href="/webdevbook/assets/js/27.fd300b2a.js"><link rel="prefetch" href="/webdevbook/assets/js/28.73ea264c.js"><link rel="prefetch" href="/webdevbook/assets/js/29.dd597f4b.js"><link rel="prefetch" href="/webdevbook/assets/js/3.70b562fb.js"><link rel="prefetch" href="/webdevbook/assets/js/30.77da4ba4.js"><link rel="prefetch" href="/webdevbook/assets/js/31.3ce42f5c.js"><link rel="prefetch" href="/webdevbook/assets/js/32.b35b82cb.js"><link rel="prefetch" href="/webdevbook/assets/js/33.d88dd89b.js"><link rel="prefetch" href="/webdevbook/assets/js/34.bde4f07f.js"><link rel="prefetch" href="/webdevbook/assets/js/4.8f334954.js"><link rel="prefetch" href="/webdevbook/assets/js/5.87b50049.js"><link rel="prefetch" href="/webdevbook/assets/js/6.512d59c2.js"><link rel="prefetch" href="/webdevbook/assets/js/7.740e5bb1.js"><link rel="prefetch" href="/webdevbook/assets/js/9.2a3e4724.js">
    <link rel="stylesheet" href="/webdevbook/assets/css/0.styles.ff1b3640.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/webdevbook/" class="home-link router-link-active"><!----> <span class="site-name">A full stack approach to integrated web and native app development</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/webdevbook/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Frontend</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Backend</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/webdevbook/backend/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/webdevbook/backend/architecture.html" aria-current="page" class="active sidebar-link">Architecture and scaffolding</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webdevbook/backend/architecture.html#graphql" class="sidebar-link">GraphQL</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/architecture.html#scaffolding" class="sidebar-link">Scaffolding</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/architecture.html#designing-your-application" class="sidebar-link">Designing your application</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webdevbook/backend/architecture.html#what-types-do-you-have-in-your-system" class="sidebar-link">What types do you have in your system?</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/architecture.html#what-are-the-relationships" class="sidebar-link">What are the relationships?</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/architecture.html#what-queries-to-do-need" class="sidebar-link">What queries to do need?</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/architecture.html#what-mutations-are-possible-on-each-type" class="sidebar-link">What mutations are possible on each type?</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/architecture.html#who-can-do-those-operations" class="sidebar-link">Who can do those operations?</a></li></ul></li></ul></li><li><a href="/webdevbook/backend/database.html" class="sidebar-link">Database</a></li><li><a href="/webdevbook/backend/testing.html" class="sidebar-link">/backend/testing.html</a></li><li><a href="/webdevbook/backend/models.html" class="sidebar-link">Models</a></li><li><a href="/webdevbook/backend/controllers.html" class="sidebar-link">Controllers</a></li><li><a href="/webdevbook/backend/authentication.html" class="sidebar-link">Authentication</a></li><li><a href="/webdevbook/backend/security.html" class="sidebar-link">/backend/security.html</a></li><li><a href="/webdevbook/backend/deployment.html" class="sidebar-link">Deployment</a></li><li><a href="/webdevbook/backend/media.html" class="sidebar-link">Media</a></li><li><a href="/webdevbook/backend/pushcommunication.html" class="sidebar-link">Push communication</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="architecture-and-scaffolding"><a href="#architecture-and-scaffolding" class="header-anchor">#</a> Architecture and scaffolding</h1> <p>We will talk about the Laravel application code structure and backend planning in this book, but we can also save a few thousand keystrokes by using a scaffold generator from GraphQL models. Let's understand what is GraphQL and how to architect it all.</p> <p>TODO
Database
Models
Controllers
Policies
Events
Routes</p> <h2 id="graphql"><a href="#graphql" class="header-anchor">#</a> GraphQL</h2> <p>TODO
What is GraphQL?
How to describe models?</p> <h2 id="scaffolding"><a href="#scaffolding" class="header-anchor">#</a> Scaffolding</h2> <p>There's a lot of structure in a regular web application to implement all the items above. So we'll use the GraphQL Schema Definition Language (SDL) to describe your data and add functionality through server-side directives. We'll use <a href="https://github.com/Corollarium/modelarium" target="_blank" rel="noopener noreferrer">Modelarium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://lighthouse-php.com" target="_blank" rel="noopener noreferrer">Lighthouse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to get rid of most of the scaffolding and focus on the code itself.</p> <p><strong>Lighthouse</strong> is a framework for serving GraphQL from Laravel.</p> <p><strong>Modelarium</strong> is a framework for generating code scaffolding from GraphQL SDL, creating all the files you need to focus on the logic itself. It generates Laravel code structure as well as frontend components with its companion <strong>Formularium</strong>.</p> <p>We'll use both extensively in this book, describing operations from the user's point of view, which is what GraphQL describes. We'll also explain what the tools are doing and generating.</p> <p>So let's add these deps to our project:</p> <div class="language- extra-class"><pre class="language-text"><code>composer require corollarium/modelarium corollarium/formularium nuwave/lighthouse
</code></pre></div><h2 id="designing-your-application"><a href="#designing-your-application" class="header-anchor">#</a> Designing your application</h2> <p>This is arguably the most important part of your application, and certainly the one that requires most thought in its design.</p> <h3 id="what-types-do-you-have-in-your-system"><a href="#what-types-do-you-have-in-your-system" class="header-anchor">#</a> What types do you have in your system?</h3> <p>The first question you have to ask yourself is what types your system will have.</p> <p>You almost certainly will have <code>Users</code>. What do they do? If it's a communication system for example, they might create <code>Posts</code> and add <code>Comments</code> to the posts, and probably giving <code>Ratings</code>.</p> <p>Or you are building an ecommerce store. Perhaps it has <code>Users</code> to save their information, but you might be selling without even creating a <code>User</code> entry and storing it all on the invoice. But you have <code>Products</code>, which might have <code>Reviews</code>, and the <code>Invoices</code> for purchases. But invoices are a complex type, with several rows of different data. So you might want an <code>InvoiceItem</code> type with the product purchasen, the amount and price, and who bought it.</p> <h3 id="what-are-the-relationships"><a href="#what-are-the-relationships" class="header-anchor">#</a> What are the relationships?</h3> <p>Remember, SQL databases do not have arrays as a primary datatype, so whenever you have an array it's probably better to store it as a relationship with another type -- like the <code>InvoiceItem</code> example. The relationships can be one-to-one, one-to-many or many-to-many. It may be a good idea to draw an ER diagram with your modeling.</p> <h3 id="what-queries-to-do-need"><a href="#what-queries-to-do-need" class="header-anchor">#</a> What queries to do need?</h3> <p>It's likely that you'll want to list the entries of a certain type, and fetch information about a specific entry. What about other queries? Perhaps searching products by name, or listing all posts with a specific tag.</p> <h3 id="what-mutations-are-possible-on-each-type"><a href="#what-mutations-are-possible-on-each-type" class="header-anchor">#</a> What mutations are possible on each type?</h3> <p>You need to be able to create a type instance, such as a new <code>Post</code> or new <code>Product</code>. Do you want to delete them though? You might want to keep them forever. What about editing? Can you change that instance after it's created? The basic operations on a type (CRUD, for Create, Read, Update, Delete) are not necessarily implemented for all types. You might not even want to expose a create operation if you have a limited, fix set of instances that are generated during the setup of your application -- for example, t-shirt sizes.</p> <p>With GraphQL all the operations that generate changes to the database are called <em>mutations</em>. We're going to list all mutations and organize them with the model type definition to make them easier to find. Sometimes creating can be a mutation in another type: for example, creating a comment can be a <code>commentPost</code> mutation. Adding new pictures can be a <code>postPhoto</code> mutation.</p> <p>List the operations that you'll use.</p> <h3 id="who-can-do-those-operations"><a href="#who-can-do-those-operations" class="header-anchor">#</a> Who can do those operations?</h3> <p>Not every operation can be done by every user. You don't want John changing Mary's profile, or Paul accessing Jane's invoices. So both queries and mutations need to be restricted with policies. For each item in your query and mutation list describe the restrictions. Do it from the start; it's better to have all endpoints blocked by default than to forget one of them.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/webdevbook/backend/introduction.html" class="prev">
        Introduction
      </a></span> <span class="next"><a href="/webdevbook/backend/database.html">
        Database
      </a>
      →
    </span></p></div> </main> <footer data-v-136409f7><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" data-v-136409f7><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" style="border-width: 0;" data-v-136409f7></a> <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type" data-v-136409f7>A full stack approach to integrated web and native app development</span>
  by
  <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName" data-v-136409f7>Bruno Barberi Gnecco</span>
  is licensed under a
  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" data-v-136409f7>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International
    License</a>.
</footer></div><div class="global-ui"></div></div>
    <script src="/webdevbook/assets/js/app.add8df03.js" defer></script><script src="/webdevbook/assets/js/2.7bd00ffb.js" defer></script><script src="/webdevbook/assets/js/8.5fbba1e4.js" defer></script>
  </body>
</html>
