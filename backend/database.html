<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Database | Web development: management, frontend and backend</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="Creating native and web apps using Vue, NativeScript and Laravel">
    <link rel="preload" href="/webdevbook/assets/css/0.styles.6f5b36b1.css" as="style"><link rel="preload" href="/webdevbook/assets/js/app.4c4efbc3.js" as="script"><link rel="preload" href="/webdevbook/assets/js/2.258d6c12.js" as="script"><link rel="preload" href="/webdevbook/assets/js/11.8ed3fab4.js" as="script"><link rel="prefetch" href="/webdevbook/assets/js/10.c87da69f.js"><link rel="prefetch" href="/webdevbook/assets/js/12.a93f3d54.js"><link rel="prefetch" href="/webdevbook/assets/js/13.1aeeb621.js"><link rel="prefetch" href="/webdevbook/assets/js/14.95d7855b.js"><link rel="prefetch" href="/webdevbook/assets/js/15.bfac4853.js"><link rel="prefetch" href="/webdevbook/assets/js/16.f3301507.js"><link rel="prefetch" href="/webdevbook/assets/js/17.0c0c23e5.js"><link rel="prefetch" href="/webdevbook/assets/js/18.4d6af17a.js"><link rel="prefetch" href="/webdevbook/assets/js/19.be8c9587.js"><link rel="prefetch" href="/webdevbook/assets/js/20.8f6dd8bd.js"><link rel="prefetch" href="/webdevbook/assets/js/21.9a0bdbdc.js"><link rel="prefetch" href="/webdevbook/assets/js/22.81b13454.js"><link rel="prefetch" href="/webdevbook/assets/js/23.a40c4fbc.js"><link rel="prefetch" href="/webdevbook/assets/js/24.851b54e9.js"><link rel="prefetch" href="/webdevbook/assets/js/25.67c32603.js"><link rel="prefetch" href="/webdevbook/assets/js/26.66229317.js"><link rel="prefetch" href="/webdevbook/assets/js/27.b0467bfe.js"><link rel="prefetch" href="/webdevbook/assets/js/28.2575ae0a.js"><link rel="prefetch" href="/webdevbook/assets/js/29.95a6bd47.js"><link rel="prefetch" href="/webdevbook/assets/js/3.d727a3b8.js"><link rel="prefetch" href="/webdevbook/assets/js/30.3608412d.js"><link rel="prefetch" href="/webdevbook/assets/js/31.e2ced364.js"><link rel="prefetch" href="/webdevbook/assets/js/32.1437a2da.js"><link rel="prefetch" href="/webdevbook/assets/js/33.b94cbcaa.js"><link rel="prefetch" href="/webdevbook/assets/js/34.4bf33957.js"><link rel="prefetch" href="/webdevbook/assets/js/35.e4fcb519.js"><link rel="prefetch" href="/webdevbook/assets/js/36.26ab1602.js"><link rel="prefetch" href="/webdevbook/assets/js/37.3d237bbe.js"><link rel="prefetch" href="/webdevbook/assets/js/38.42a47cdc.js"><link rel="prefetch" href="/webdevbook/assets/js/39.60a8024c.js"><link rel="prefetch" href="/webdevbook/assets/js/4.c0e70bc7.js"><link rel="prefetch" href="/webdevbook/assets/js/40.2a034950.js"><link rel="prefetch" href="/webdevbook/assets/js/41.cfef1a3a.js"><link rel="prefetch" href="/webdevbook/assets/js/42.ec88c83c.js"><link rel="prefetch" href="/webdevbook/assets/js/43.f280ce09.js"><link rel="prefetch" href="/webdevbook/assets/js/44.01451660.js"><link rel="prefetch" href="/webdevbook/assets/js/45.fafebbe9.js"><link rel="prefetch" href="/webdevbook/assets/js/46.f69485fa.js"><link rel="prefetch" href="/webdevbook/assets/js/5.cda929b9.js"><link rel="prefetch" href="/webdevbook/assets/js/6.423fdf70.js"><link rel="prefetch" href="/webdevbook/assets/js/7.1d048464.js"><link rel="prefetch" href="/webdevbook/assets/js/8.1f0319bc.js"><link rel="prefetch" href="/webdevbook/assets/js/9.f8fb6885.js">
    <link rel="stylesheet" href="/webdevbook/assets/css/0.styles.6f5b36b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/webdevbook/" class="home-link router-link-active"><!----> <span class="site-name">Web development: management, frontend and backend</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/webdevbook/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Software projects</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Frontend</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Backend</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/webdevbook/backend/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/webdevbook/backend/architecture.html" class="sidebar-link">Architecture</a></li><li><a href="/webdevbook/backend/structure.html" class="sidebar-link">Code structure</a></li><li><a href="/webdevbook/backend/setup.html" class="sidebar-link">Setup the project</a></li><li><a href="/webdevbook/backend/testing.html" class="sidebar-link">Testing</a></li><li><a href="/webdevbook/backend/models.html" class="sidebar-link">Models</a></li><li><a href="/webdevbook/backend/database.html" aria-current="page" class="active sidebar-link">Database</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#database-2" class="sidebar-link">Database</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#how-to-plan-a-proper-sql-schema" class="sidebar-link">How to plan a proper SQL schema</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#migrations" class="sidebar-link">Migrations</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#relationships" class="sidebar-link">Relationships</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#one-to-one" class="sidebar-link">One to one</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#one-to-many" class="sidebar-link">One to many</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#many-to-many" class="sidebar-link">Many to many</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#polymorphic-one-to-one" class="sidebar-link">Polymorphic one-to-one</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#polymorphic-many-to-one" class="sidebar-link">Polymorphic many-to-one</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#polymorphic-many-to-many" class="sidebar-link">Polymorphic many-to-many</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#indices" class="sidebar-link">Indices</a></li></ul></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#seeding" class="sidebar-link">Seeding</a></li><li class="sidebar-sub-header"><a href="/webdevbook/backend/database.html#factories" class="sidebar-link">Factories</a></li></ul></li><li><a href="/webdevbook/backend/routing.html" class="sidebar-link">Routing</a></li><li><a href="/webdevbook/backend/controllers.html" class="sidebar-link">Controllers</a></li><li><a href="/webdevbook/backend/authentication.html" class="sidebar-link">Authentication</a></li><li><a href="/webdevbook/backend/security.html" class="sidebar-link">Security</a></li><li><a href="/webdevbook/backend/deployment.html" class="sidebar-link">Deployment</a></li><li><a href="/webdevbook/backend/ssr.html" class="sidebar-link">Server side rendering</a></li><li><a href="/webdevbook/backend/media.html" class="sidebar-link">Media</a></li><li><a href="/webdevbook/backend/pushcommunication.html" class="sidebar-link">Push communication</a></li><li><a href="/webdevbook/backend/scraping.html" class="sidebar-link">Scraping and crawlers</a></li><li><a href="/webdevbook/backend/last.html" class="sidebar-link">Where to go from here</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="database"><a href="#database" class="header-anchor">#</a> Database</h1> <h2 id="database-2"><a href="#database-2" class="header-anchor">#</a> Database</h2> <p>There are many flavors of databases these days. Classic SQL running locally, NoSQL, many cloud solutions. As this is not a devops book, we'll not dive deeply into setup of database software, such as MariaDB, MySQL or PostgreSQL. Cloud solutions often have a SQL service, such as <a href="https://aws.amazon.com/rds/" target="_blank" rel="noopener noreferrer">AWS RDS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://www.digitalocean.com/docs/databases/" target="_blank" rel="noopener noreferrer">Digital Ocean Managed Databases<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and a multitude of other services. So you can use this book with your favorite cloud provider following its instructions for configuration.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you are using <a href="https://github.com/Corollarium/modelarium" target="_blank" rel="noopener noreferrer">Modelarium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, migrations, factory and seed files are automatically created for you.</p></div> <p>It's wise that the developer uses the same kind of database you are using in production, so install MySQL, PostgreSQL, SQL Server or your favorite flavor locally. It's essential for a CI server to use the same flavor and version, or you might miss a few bugs that will only be detected in production -- you might even use the same database server, at least while you're small. Note that although we showed how to use SQLite in the <a href="/webdevbook/backend/introduction.html">introduction</a>, since it's trivial to setup and use, it is a more limited DB by definition. You probably don't want to use it in production for websites, unless it's a small project.</p> <p>While you might need to use SQL queries directly in your code, we'll deal here with Eloquent, Laravel's ORM.</p> <h2 id="how-to-plan-a-proper-sql-schema"><a href="#how-to-plan-a-proper-sql-schema" class="header-anchor">#</a> How to plan a proper SQL schema</h2> <p>TODO</p> <h2 id="migrations"><a href="#migrations" class="header-anchor">#</a> Migrations</h2> <p>Migrations are the files that create or alter the database schema. They are responsible for creating tables for your <a href="/webdevbook/backend/models.html">models</a>.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you are using Modelarium the migration files are created for you, and automatically reflect what is on the model declaration as well.</p></div> <p>Laravel reads migrations from the <code>database/migration</code> directory. Every time you need to change a database in production you add a new migration patch in a separate file -- this means that old migrations might not reflect the current schema, so don't just read them on systems that have patches, check the actual database schema. You can create a migration file with <code>artisan make:migration</code>.</p> <h2 id="relationships"><a href="#relationships" class="header-anchor">#</a> Relationships</h2> <p>We already explained <a href="/webdevbook/backend/models.html">what relationships are in the models chapter</a>, so we'll go straight into how to create them in this chapter.</p> <h3 id="one-to-one"><a href="#one-to-one" class="header-anchor">#</a> One to one</h3> <p>One to one and one to many relationships are written the same way in the migration. The only difference is in the model.</p> <h3 id="one-to-many"><a href="#one-to-many" class="header-anchor">#</a> One to many</h3> <p>If we were doing everything manually first we'd declare source type migration, users (the <code>1</code> part of <code>1:n</code>). Notice that the database doesn't know about the other side of the relationship in this side:</p> <div class="language-php extra-class"><pre class="language-php"><code>    Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Blueprint <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bigIncrements</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'email'</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">rememberToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>It's on the target type that you declare the relationship:</p> <div class="language-php extra-class"><pre class="language-php"><code>    Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'post'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Blueprint <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bigIncrements</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'content'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unsignedBigInteger</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;user_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">foreign</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;user_id&quot;</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">references</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onDelete</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;cascade&quot;</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onUpdate</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;cascade&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="many-to-many"><a href="#many-to-many" class="header-anchor">#</a> Many to many</h3> <p>To build a many to many relationship we need a third table. No changes to the user table:</p> <div class="language-php extra-class"><pre class="language-php"><code>Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Blueprint <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'email'</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">rememberToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The other part of the relationship also does not have any foreign ids or keys:</p> <div class="language-php extra-class"><pre class="language-php"><code>Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'roles'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Blueprint <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The relationship is handled by the third table, also called a pivot table, which holds keys for both models at once:</p> <div class="language-php extra-class"><pre class="language-php"><code>Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'role_user'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Blueprint <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unsignedBigInteger</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unsignedBigInteger</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'role_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">foreign</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user_id'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">references</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onDelete</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'cascade'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">foreign</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'role_id'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">references</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'roles'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onDelete</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'cascade'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Notice that the table name, <code>role_user</code>, is composed of the singular names of both tables in alphabetical order, separated by an underscore. You can create a pivot table with <code>artisan make:migration:pivot</code>.</p> <h3 id="polymorphic-one-to-one"><a href="#polymorphic-one-to-one" class="header-anchor">#</a> Polymorphic one-to-one</h3> <p>Once again, the migrations for the one-to-one and one-to-many are the same. See below.</p> <h3 id="polymorphic-many-to-one"><a href="#polymorphic-many-to-one" class="header-anchor">#</a> Polymorphic many-to-one</h3> <p>Polymorphic relationships, require some special fields, to hold information about the target type, so it can be correctly instantiated. Imagine you have an image field that is 1:1:</p> <div class="language-php extra-class"><pre class="language-php"><code>Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'images'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Blueprint <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unsignedBigInteger</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'imageable_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'imageable_type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'imageable_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note the <code>able_id</code> and <code>able_type</code> suffixes added to the new fields. You might want to add the index for faster access.</p> <h3 id="polymorphic-many-to-many"><a href="#polymorphic-many-to-many" class="header-anchor">#</a> Polymorphic many-to-many</h3> <p>This mixes all the techniques above. Let's add a tags table:</p> <div class="language-php extra-class"><pre class="language-php"><code>Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'tags'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Blueprint <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">increments</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>It will have a many-to-many relationship with posts, comments, users. Here's the pivot table:</p> <div class="language-php extra-class"><pre class="language-php"><code>Schema<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'taggables'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Blueprint <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unsignedBigInteger</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'tag_id'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">references</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'tags'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onDelete</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'cascade'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unsignedBigInteger</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'taggable_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'taggable_type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$table</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'taggable_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>An index was added to speed up access.</p> <h3 id="indices"><a href="#indices" class="header-anchor">#</a> Indices</h3> <p>Databases use indices (also known as keys) to speed up access to records. If you don't have an index, you have to sweep the entire table to match a value to a query. With indices this time is cut drastically, reducing the complexity to <code>O(1)</code> or <code>O(log(n))</code>.</p> <p>Indices, like everything else in life, don't come free. They take extra storage (disk and memory) and extra time during insertion, delete and updating an entry. It's just not a good idea to add indices to all fields. There's much that influences when to create indices, but a basic set of guidelines is this:</p> <ul><li><p>your id field should be a primary index. Laravel does that for you with <code>increments()</code>. It's hardly ever a good idea to use a primary index that is not a sequential integer -- the only other usual use case for this is using a unique hash, such as UUID, when it's hard to have a sequential index for some reason. If you think you need something else for a primary key: think twice.</p></li> <li><p>the database is the best place to ensure uniqueness. If you have a unique field, such as the email for users, use a unique index. Any constraints that you can add to the database are good, since you'll be sure they won't be violated even if there is a bug in your code.</p></li> <li><p>if you have a field that is constantly queried, consider adding an index to it. This is relevant for relationship id fields, for example: you'll constantly query the relationship and an index is almost certainly going to help and it faster.</p></li> <li><p>if you have fields that are queried together, add a multiple index: that is an index on all of them like <code>-&gt;index('field1', 'otherfield2')</code>.</p></li> <li><p>do not add indices to fields that have little variation of data. Adding an index to a <code>gender</code> or a <code>year</code> field won't help much.</p></li> <li><p>finally, there are some special index types that can help with particular queries and data types. For example, if you do a lot of word searches you want a full-text index. If you use spatial data you can benefit from a spatial index. Each database implements these slightly different (or doesn't at all), so you'll have to read its manual.</p></li></ul> <p>You want to keep as few indices as necessary. To make sure your index is being used and help, run an <code>EXPLAIN</code> query: this is a command databases have that detail how the query is being processed and what indices are used. Laravel has <a href="https://laravel.com/docs/telescope" target="_blank" rel="noopener noreferrer">Telescope<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, a tool that logs queries and helps you see which ones are slow.</p> <h2 id="seeding"><a href="#seeding" class="header-anchor">#</a> Seeding</h2> <p>Seeding means creating fake entries in your database, so you can easily test the system.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you are using <a href="https://github.com/Corollarium/modelarium" target="_blank" rel="noopener noreferrer">Modelarium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> the seed files are created for you, and automatically reflect what is on the model declaration as well. You only have to add them to the <code>DatabaseSeeder</code>.</p></div> <p>Laravel has a simple seed system. The files are in <code>database/seeds</code> and you can create a seed file with <code>artisan make:seed</code>.</p> <p>A seeder is simply a class that creates one or more entries in the database. The most basic example to seed users creates an entry directly on the database:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">UserSeeder</span> <span class="token keyword">extends</span> <span class="token class-name">Seeder</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Run the database seeds.
     *
     * @return void
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token constant">DB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'users'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Str<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'email'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Str<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'@email.com'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Hash<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This is not a good idea, though. It goes over the model and might easily get out of synchrony when new fields are added. A better way to do it is to use a factory (which we'll see below):</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">UserSeeder</span> <span class="token keyword">extends</span> <span class="token class-name">Seeder</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span>App\<span class="token package">Models<span class="token punctuation">\</span>User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Creating good fake data is not as easy as it seems. There's a great package for it in PHP, <a href="https://github.com/fzaninotto/Faker" target="_blank" rel="noopener noreferrer">Faker<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. You should use it as much as you can. Seeding relationships can be very tricky. You need to create objects in the right order and properly fill the data, which compounds the problem. Here's how you can use a seeder to create 50 users, each of them with a post:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">UserSeeder</span> <span class="token keyword">extends</span> <span class="token class-name">Seeder</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">factory</span><span class="token punctuation">(</span>App\<span class="token package">Models<span class="token punctuation">\</span>User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">posts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">factory</span><span class="token punctuation">(</span>App\<span class="token package">Models<span class="token punctuation">\</span>Post</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally, remember to edit the <code>DatabaseSeeder</code> class to call all your seeders and in the correct order. It will look like this:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        UserSeeder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        PostSeeder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        CommentSeeder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token comment">// etc</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It's best if can use a tool to generate your seeders.</p> <p>To actually run the seeders, use artisan. You can run them all or just one of them:</p> <div class="language- extra-class"><pre class="language-text"><code>php artisan db:seed

php artisan db:seed --class=UserSeeder
</code></pre></div><h2 id="factories"><a href="#factories" class="header-anchor">#</a> Factories</h2> <p>Factories are incredibly useful for unit testing and for seeders. They work by filling the fields of your model with proper random data, which then can be saved to the database or manipulated.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you are using <a href="https://github.com/Corollarium/modelarium" target="_blank" rel="noopener noreferrer">Modelarium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> the factory files are created for you, and automatically reflect what is on the model declaration as well. You don't have to do anything!</p></div> <p>So, here's how you can generate data, using <code>Faker</code>, with a factory:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Faker<span class="token punctuation">\</span>Generator</span> <span class="token keyword">as</span> Faker<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Str</span><span class="token punctuation">;</span>

<span class="token variable">$factory</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">define</span><span class="token punctuation">(</span>App\<span class="token package">User</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Faker <span class="token variable">$faker</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">name</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'email'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">safeEmail</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'email_verified_at'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Hash<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'password'</span><span class="token punctuation">)</span>
        <span class="token single-quoted-string string">'remember_token'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Str<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Laravel 8.x changed the old format and now uses classes, so it changes the code slightly:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">UserFactory</span> <span class="token keyword">extends</span> <span class="token class-name">Factory</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * The name of the factory's corresponding model.
     *
     * @var string
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Define the model's default state.
     *
     * @return array
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">definition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">faker</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">name</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'email'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">faker</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">safeEmail</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'email_verified_at'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'password'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Hash<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'remember_token'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> Str<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can create a factory file with artisan:</p> <div class="language- extra-class"><pre class="language-text"><code>php artisan make:factory PostFactory
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/webdevbook/backend/models.html" class="prev">
        Models
      </a></span> <span class="next"><a href="/webdevbook/backend/routing.html">
        Routing
      </a>
      →
    </span></p></div> </main> <footer data-v-136409f7><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" data-v-136409f7><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" style="border-width: 0;" data-v-136409f7></a> <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type" data-v-136409f7>A full stack approach to integrated web and native app development</span>
  by
  <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName" data-v-136409f7>Bruno Barberi Gnecco</span>
  is licensed under a
  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" data-v-136409f7>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International
    License</a>.
</footer></div><div class="global-ui"></div></div>
    <script src="/webdevbook/assets/js/app.4c4efbc3.js" defer></script><script src="/webdevbook/assets/js/2.258d6c12.js" defer></script><script src="/webdevbook/assets/js/11.8ed3fab4.js" defer></script>
  </body>
</html>
