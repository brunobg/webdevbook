(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{373:function(e,t,a){"use strict";a.r(t);var o=a(42),r=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"code-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#code-structure"}},[e._v("#")]),e._v(" Code structure")]),e._v(" "),a("p",[e._v("We will talk about the Laravel application code structure and backend planning in this book, but we can also save a few thousand keystrokes by using a scaffold generator from GraphQL models.")]),e._v(" "),a("h2",{attrs:{id:"backend-structure-overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#backend-structure-overview"}},[e._v("#")]),e._v(" Backend structure overview")]),e._v(" "),a("p",[e._v("You start with your database. You will have code create the tables and patch the database when the application needs changes. These are often called "),a("strong",[e._v("migrations")]),e._v(". Laravel adopts a standard that you never overwrite existing migration files, you create a new one that patches the database. The advantage is that you can easily upgrade existing installations, but sometimes it can be tricky to understand what the database actually is when you have many migrations changing the original layout.")]),e._v(" "),a("p",[e._v("To test an application you need to create some data, or "),a("strong",[e._v("seed")]),e._v(" it. You also have "),a("strong",[e._v("database factories")]),e._v(" in Laravel, which define how to generate random data for the seeding. Laravel stores all this in the "),a("code",[e._v("database")]),e._v(" folder, with subfolders for seeds, migrations and factories.")]),e._v(" "),a("p",[e._v("Each type in your database will have one (or more) tables, and it will be mapped to code onto a "),a("strong",[e._v("model")]),e._v(". Model classes store data when you are processing it, and are how you create or update entries.")]),e._v(" "),a("p",[e._v("Moving on, web applications define "),a("strong",[e._v("routes")]),e._v(". This explains to the server how to map a HTTP request it received a certain URL onto actual code to run. In Laravel routes are in the "),a("code",[e._v("routes")]),e._v(" directory. You also can define middleware in your routes; that is, code that changes its behavior. For example, you can define that some routes require the user to be authenticated.")]),e._v(" "),a("p",[e._v("Each route maps a URL to a method in a "),a("strong",[e._v("controller")]),e._v(". Controllers are classes that translate the HTTP request into what to run.")]),e._v(" "),a("p",[e._v("Every time you get a request, you need to "),a("strong",[e._v("validate")]),e._v(" it, because you are not sure if the user is not trying to do something malicious. While we'll talk about validation in depth later, it's important to make it as automatic as possible. Many security holes come from improperly validated data. One can validate data on the controller or on the model. Doing it on the model is safer -- you are sure that data is checked whenever the model is changed, and you don't have to add new checks each time you write a new controller endpoint, which is particularly annoying with REST endpoints. With Graphql the endpoint can be entirely controlled by a library that ensures that validation is properly applied. Even so, you might call the models directly -- for example, when seeding or when importing data from a script. If your data is validated on the model you are always sure that it's correct.")]),e._v(" "),a("p",[e._v("Not every user will be allowed to do every action in your system. That why we have "),a("strong",[e._v("policies")]),e._v(", to grant access to actions based on the user who made the request and the model data. For example, only the original poster may change a post, but anybody can comment on it.")]),e._v(" "),a("p",[e._v("Things are happening on the application as a whole and sometimes you want to perform certain actions when certain things happen. For example, you want to send a welcome email when a user registers, or send them a notification when there's a new message for them. That's when you use "),a("strong",[e._v("events")]),e._v(" and "),a("strong",[e._v("listeners")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"how-we-ll-save-hours-of-scaffolding"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-we-ll-save-hours-of-scaffolding"}},[e._v("#")]),e._v(" How we'll save hours of scaffolding")]),e._v(" "),a("p",[e._v("As you can see, there's a lot of structure in a regular web application to implement all the items above.")]),e._v(" "),a("p",[e._v("While you can create all this by hand (and Laravel helps you with Artisan commands that create classes for you), in this book we'll use the GraphQL Schema Definition Language (SDL) to describe your data and add functionality through server-side directives. We'll use "),a("a",{attrs:{href:"https://github.com/Corollarium/modelarium",target:"_blank",rel:"noopener noreferrer"}},[e._v("Modelarium"),a("OutboundLink")],1),e._v(" and "),a("a",{attrs:{href:"https://lighthouse-php.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Lighthouse"),a("OutboundLink")],1),e._v(" to get rid of most of the scaffolding and focus on the code itself.")]),e._v(" "),a("p",[a("strong",[e._v("Lighthouse")]),e._v(" is a framework for serving GraphQL from Laravel.")]),e._v(" "),a("p",[a("strong",[e._v("Modelarium")]),e._v(" is a framework for generating code scaffolding from GraphQL SDL, creating all the files you need to focus on the logic itself. It generates Laravel code structure as well as frontend components with its companion "),a("a",{attrs:{href:"https://github.com/Corollarium/Formularium",target:"_blank",rel:"noopener noreferrer"}},[e._v("Formularium"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("We'll use both extensively in this book, but most of the time you won't notice they're there. We'll explain what the tools are doing and generating, but we'll save a lot of typing by using them.")]),e._v(" "),a("p",[e._v("So let's add these deps to our project:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("composer require corollarium/modelarium corollarium/formularium nuwave/lighthouse\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);